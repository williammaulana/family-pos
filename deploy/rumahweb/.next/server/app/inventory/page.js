(()=>{var e={};e.id=1268,e.ids=[1268],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},90294:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>h,tree:()=>c}),t(80156),t(82959),t(60281);var a=t(65239),r=t(93006),i=t(8751),n=t.n(i),l=t(86747),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["inventory",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,80156)),"/workspace/app/inventory/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,82959)),"/workspace/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,60281,23)),"next/dist/client/components/not-found-error"]}],o=["/workspace/app/inventory/page.tsx"],m="/inventory/page",x={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/inventory/page",pathname:"/inventory",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},97156:(e,s,t)=>{Promise.resolve().then(t.bind(t,48789))},48789:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>z});var a=t(51582),r=t(61751),i=t(18950),n=t(3372),l=t(6151),d=t(6901),c=t(3191),o=t(20013),m=t(56897),x=t(4682),h=t(95151),u=t(63632),p=t(94650),j=t(15040),g=t(32595),v=t(20334),f=t(51366);function k({onEditProduct:e,onDeleteProduct:s,onAdjustStock:t,onViewProduct:i,refreshTrigger:n}){let[l,k]=(0,r.useState)(""),[y,b]=(0,r.useState)("Semua"),[N,w]=(0,r.useState)([]),[S,C]=(0,r.useState)(["Semua"]),[P,T]=(0,r.useState)(!0),_=N.filter(e=>{let s=e.name.toLowerCase().includes(l.toLowerCase())||e.barcode?.includes(l)||e.category.toLowerCase().includes(l.toLowerCase()),t="Semua"===y||e.category===y;return s&&t}),I=e=>0===e.stock?{label:"Habis",variant:"destructive"}:e.stock<=e.min_stock?{label:"Menipis",variant:"secondary"}:{label:"Tersedia",variant:"default"};return P?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[a.jsx(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx(o.I,{placeholder:"Memuat produk...",disabled:!0,className:"pl-10"})]}),a.jsx("div",{className:"w-32 h-10 bg-gray-200 rounded animate-pulse"})]}),a.jsx("div",{className:"border rounded-lg",children:(0,a.jsxs)(d.iA,{children:[a.jsx(d.xD,{children:(0,a.jsxs)(d.SC,{children:[a.jsx(d.ss,{children:"Produk"}),a.jsx(d.ss,{children:"Kategori"}),a.jsx(d.ss,{children:"Harga Jual"}),a.jsx(d.ss,{children:"Harga Modal"}),a.jsx(d.ss,{children:"Stok"}),a.jsx(d.ss,{children:"Status"}),a.jsx(d.ss,{children:"Barcode"}),a.jsx(d.ss,{className:"text-right",children:"Aksi"})]})}),a.jsx(d.RM,{children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)(d.SC,{children:[a.jsx(d.pj,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 animate-pulse"}),a.jsx("div",{className:"h-3 bg-gray-200 rounded w-20 animate-pulse"})]})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 animate-pulse"})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 animate-pulse"})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 animate-pulse"})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-4 bg-gray-200 rounded w-16 animate-pulse"})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-6 bg-gray-200 rounded w-16 animate-pulse"})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 animate-pulse"})}),a.jsx(d.pj,{children:a.jsx("div",{className:"h-8 bg-gray-200 rounded w-24 animate-pulse ml-auto"})})]},s))})]})})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[a.jsx(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx(o.I,{placeholder:"Cari produk, kategori, atau barcode...",value:l,onChange:e=>k(e.target.value),className:"pl-10"})]}),a.jsx("select",{value:y,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md bg-white",children:S.map(e=>a.jsx("option",{value:e,children:e},e))})]}),a.jsx("div",{className:"border rounded-lg",children:(0,a.jsxs)(d.iA,{children:[a.jsx(d.xD,{children:(0,a.jsxs)(d.SC,{children:[a.jsx(d.ss,{children:"Produk"}),a.jsx(d.ss,{children:"Kategori"}),a.jsx(d.ss,{children:"Harga Jual"}),a.jsx(d.ss,{children:"Harga Modal"}),a.jsx(d.ss,{children:"Stok"}),a.jsx(d.ss,{children:"Status"}),a.jsx(d.ss,{children:"Barcode"}),a.jsx(d.ss,{className:"text-right",children:"Aksi"})]})}),a.jsx(d.RM,{children:_.map(r=>{let n=I(r),l=r.costPrice??r.cost_price;return(0,a.jsxs)(d.SC,{children:[a.jsx(d.pj,{children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:r.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[r.unit?`${r.unit}`:""," ",r.barcode?`â€¢ ${r.barcode}`:""]})]})}),a.jsx(d.pj,{children:r.category}),a.jsx(d.pj,{children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:(0,f.xG)(r.price)}),null!=l&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Profit: ",(0,f.xG)(r.price-Number(l))]})]})}),a.jsx(d.pj,{children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:(0,f.xG)(r.costPrice||0)}),r.costPrice&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Margin: ",r.price>0?Math.round((r.price-r.costPrice)/r.price*100):0,"%"]})]})}),a.jsx(d.pj,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:r.stock}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["/ min ",r.min_stock??r.minStock]})]})}),a.jsx(d.pj,{children:a.jsx(m.C,{variant:n.variant,children:n.label})}),a.jsx(d.pj,{children:a.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:r.barcode||"-"})}),a.jsx(d.pj,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[a.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>t(r.id,-1),disabled:0===r.stock,children:a.jsx(u.Z,{className:"h-4 w-4"})}),a.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>t(r.id,1),children:a.jsx(p.Z,{className:"h-4 w-4"})}),(0,a.jsxs)(x.h_,{children:[a.jsx(x.$F,{asChild:!0,children:a.jsx(c.z,{variant:"ghost",size:"sm",children:a.jsx(j.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(x.AW,{align:"end",children:[i&&a.jsx(x.Xi,{onClick:()=>i(r),children:"Detail"}),(0,a.jsxs)(x.Xi,{onClick:()=>e(r),children:[a.jsx(g.Z,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,a.jsxs)(x.Xi,{onClick:()=>s(r.id),className:"text-red-600",children:[a.jsx(v.Z,{className:"h-4 w-4 mr-2"}),"Hapus"]})]})]})]})})]},r.id)})})]})}),0===_.length&&!P&&a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a.jsx("p",{children:"Tidak ada produk ditemukan"})})]})}var y=t(70103);function b({className:e,...s}){return a.jsx("textarea",{"data-slot":"textarea",className:(0,f.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}var N=t(37377),w=t(66276);let S=["Makanan","Minuman","Kebersihan","Elektronik","Pakaian","Lainnya"],C=["pcs","dus","liter","kg","gram","meter","cm","buah","bungkus","botol","kaleng","paket"];function P({product:e,isOpen:s,onClose:t,onSave:i,isLoading:n}){let[l,d]=(0,r.useState)({name:"",category:"",price:"",costPrice:"",stock:"",minStock:"",barcode:"",unit:"",description:""}),m=(e,s)=>{d(t=>({...t,[e]:s}))};return a.jsx(N.Vq,{open:s,onOpenChange:t,children:(0,a.jsxs)(N.cZ,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(N.fK,{children:[a.jsx(N.$N,{children:e?"Edit Produk":"Tambah Produk Baru"}),a.jsx(N.Be,{children:e?"Ubah informasi produk di bawah ini.":"Masukkan informasi produk baru."})]}),(0,a.jsxs)("form",{onSubmit:s=>{s.preventDefault();let t={name:l.name,category:l.category,price:Number.parseFloat(l.price),costPrice:l.costPrice?Number.parseFloat(l.costPrice):void 0,stock:Number.parseInt(l.stock),minStock:Number.parseInt(l.minStock),barcode:l.barcode||void 0,unit:l.unit||void 0};e&&(t.id=e.id),i(t)},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"name",children:"Nama Produk *"}),a.jsx(o.I,{id:"name",value:l.name,onChange:e=>m("name",e.target.value),placeholder:"Masukkan nama produk",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"category",children:"Kategori *"}),(0,a.jsxs)(w.Ph,{value:l.category,onValueChange:e=>m("category",e),children:[a.jsx(w.i4,{children:a.jsx(w.ki,{placeholder:"Pilih kategori"})}),a.jsx(w.Bw,{children:S.map(e=>a.jsx(w.Ql,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"price",children:"Harga Jual *"}),a.jsx(o.I,{id:"price",type:"number",value:l.price,onChange:e=>m("price",e.target.value),placeholder:"0",min:"0",step:"100",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"costPrice",children:"Harga Modal"}),a.jsx(o.I,{id:"costPrice",type:"number",value:l.costPrice,onChange:e=>m("costPrice",e.target.value),placeholder:"0",min:"0",step:"100"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"unit",children:"Satuan"}),(0,a.jsxs)(w.Ph,{value:l.unit,onValueChange:e=>m("unit",e),children:[a.jsx(w.i4,{children:a.jsx(w.ki,{placeholder:"Pilih satuan"})}),a.jsx(w.Bw,{children:C.map(e=>a.jsx(w.Ql,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"barcode",children:"Barcode"}),a.jsx(o.I,{id:"barcode",value:l.barcode,onChange:e=>m("barcode",e.target.value),placeholder:"Scan atau masukkan barcode"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"stock",children:"Stok Awal *"}),a.jsx(o.I,{id:"stock",type:"number",value:l.stock,onChange:e=>m("stock",e.target.value),placeholder:"0",min:"0",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"minStock",children:"Stok Minimum *"}),a.jsx(o.I,{id:"minStock",type:"number",value:l.minStock,onChange:e=>m("minStock",e.target.value),placeholder:"0",min:"0",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"description",children:"Deskripsi"}),a.jsx(b,{id:"description",value:l.description,onChange:e=>m("description",e.target.value),placeholder:"Deskripsi produk (opsional)",rows:3})]}),(0,a.jsxs)(N.cN,{children:[a.jsx(c.z,{type:"button",variant:"outline",onClick:t,children:"Batal"}),a.jsx(c.z,{type:"submit",disabled:n,children:n?"Menyimpan...":e?"Update":"Simpan"})]})]})]})})}function T({isOpen:e,onClose:s,onAdjust:t,productName:i,currentStock:n,isLoading:l}){let[d,m]=(0,r.useState)("add"),[x,h]=(0,r.useState)(""),[u,p]=(0,r.useState)(""),j="add"===d?n+Number.parseInt(x||"0"):n-Number.parseInt(x||"0");return a.jsx(N.Vq,{open:e,onOpenChange:s,children:(0,a.jsxs)(N.cZ,{className:"sm:max-w-[400px]",children:[(0,a.jsxs)(N.fK,{children:[a.jsx(N.$N,{children:"Penyesuaian Stok"}),(0,a.jsxs)(N.Be,{children:["Sesuaikan stok untuk produk: ",a.jsx("strong",{children:i})]})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t("add"===d?Number.parseInt(x):-Number.parseInt(x),u,d),h(""),p("")},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{children:"Jenis Penyesuaian"}),(0,a.jsxs)(w.Ph,{value:d,onValueChange:m,children:[a.jsx(w.i4,{children:a.jsx(w.ki,{})}),(0,a.jsxs)(w.Bw,{children:[a.jsx(w.Ql,{value:"add",children:"Tambah Stok"}),a.jsx(w.Ql,{value:"reduce",children:"Kurangi Stok"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"quantity",children:"Jumlah"}),a.jsx(o.I,{id:"quantity",type:"number",value:x,onChange:e=>h(e.target.value),placeholder:"0",min:"1",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(y._,{htmlFor:"reason",children:"Alasan"}),a.jsx(b,{id:"reason",value:u,onChange:e=>p(e.target.value),placeholder:"Masukkan alasan penyesuaian stok",rows:3,required:!0})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Stok Saat Ini:"}),a.jsx("span",{className:"font-medium",children:n})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Penyesuaian:"}),(0,a.jsxs)("span",{className:"add"===d?"text-green-600":"text-red-600",children:["add"===d?"+":"-",x||0]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-bold border-t pt-2 mt-2",children:[a.jsx("span",{children:"Stok Baru:"}),a.jsx("span",{className:j<0?"text-red-600":"",children:j})]})]}),j<0&&a.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:"Peringatan: Stok tidak boleh kurang dari 0"}),(0,a.jsxs)(N.cN,{children:[a.jsx(c.z,{type:"button",variant:"outline",onClick:s,children:"Batal"}),a.jsx(c.z,{type:"submit",disabled:l||j<0,children:l?"Memproses...":"Sesuaikan Stok"})]})]})]})})}function _({product:e,isOpen:s,onClose:t}){let r=e?e.costPrice??e.cost_price:void 0,i=e?e.minStock??e.min_stock:void 0;return a.jsx(N.Vq,{open:s,onOpenChange:t,children:(0,a.jsxs)(N.cZ,{className:"sm:max-w-[480px]",children:[(0,a.jsxs)(N.fK,{children:[a.jsx(N.$N,{children:"Detail Produk"}),a.jsx(N.Be,{children:"Informasi lengkap produk"})]}),e&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Nama"}),a.jsx("div",{className:"font-medium",children:e.name})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Kategori"}),a.jsx("div",{className:"font-medium",children:e.category})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Barcode"}),a.jsx("div",{className:"font-medium",children:e.barcode||"-"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Harga Jual"}),a.jsx("div",{className:"font-semibold text-blue-600",children:(0,f.xG)(e.price)})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Harga Modal"}),a.jsx("div",{className:"font-semibold",children:void 0!==r?(0,f.xG)(Number(r)):"-"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Stok"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(m.C,{variant:"secondary",children:e.stock}),void 0!==i&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["/ min ",i]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Satuan"}),a.jsx("div",{className:"font-medium",children:e.unit||"-"})]})]}),e.description&&(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground",children:"Deskripsi"}),a.jsx("div",{className:"text-sm",children:e.description})]})]})]})})}var I=t(82546),M=t(56733);let Z=(0,t(75475).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var A=t(1817),$=t(24358),E=t(51250);function D({isOpen:e,onClose:s,onImportComplete:t}){let[i,n]=(0,r.useState)(null),[l,d]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),[h,u]=(0,r.useState)([]),{toast:p}=(0,E.pm)(),j=async e=>{let s=e.target.files?.[0];if(!s)return;let t="text/csv"===s.type||s.name.endsWith(".csv"),a=s.name.endsWith(".xlsx")||s.name.endsWith(".xls")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===s.type;if(t||a){n(s),u([]);try{let e;if(t){let t=new FileReader;t.onload=s=>{let t=s.target?.result;e=(0,$.bW)(t),x(e.slice(0,6))},t.readAsText(s)}else e=await (0,$.gY)(s),x(e.slice(0,6))}catch(e){p({title:"Error membaca file",description:"Terjadi kesalahan saat membaca file",variant:"destructive"})}}else p({title:"File tidak valid",description:"Silakan pilih file CSV atau Excel (.xlsx) yang valid",variant:"destructive"})},g=e=>{let s=[],t=e[0],a=["name","sku","category","price","stock","min_stock"].filter(e=>!t.some(s=>s.toLowerCase().includes(e)));a.length>0&&s.push(`Missing required columns: ${a.join(", ")}`);for(let a=1;a<e.length;a++){let r=e[a];r.length!==t.length&&s.push(`Row ${a+1}: Column count mismatch`);let i=t.findIndex(e=>e.toLowerCase().includes("price")),n=t.findIndex(e=>e.toLowerCase().includes("stock"));i>=0&&isNaN(Number(r[i]))&&s.push(`Row ${a+1}: Invalid price value`),n>=0&&isNaN(Number(r[n]))&&s.push(`Row ${a+1}: Invalid stock value`)}return s},v=async()=>{if(i&&m){d(!0);try{let e;if(i.name.endsWith(".csv")){let s=new FileReader;s.onload=async s=>{let t=s.target?.result;e=(0,$.bW)(t),await f(e)},s.readAsText(i)}else e=await (0,$.gY)(i),await f(e)}catch(e){p({title:"Import Gagal",description:"Terjadi kesalahan saat mengimpor data",variant:"destructive"}),d(!1)}}},f=async e=>{let a=g(e);if(a.length>0){u(a),d(!1);return}let r=e[0],i=r.findIndex(e=>e.toLowerCase().includes("name")),l=r.findIndex(e=>e.toLowerCase().includes("sku")),c=r.findIndex(e=>e.toLowerCase().includes("category")),o=r.findIndex(e=>e.toLowerCase().includes("price")),m=r.findIndex(e=>e.toLowerCase().includes("stock")),h=r.findIndex(e=>e.toLowerCase().includes("min_stock")),j=0,v=0;for(let s=1;s<e.length;s++){let t=e[s];try{let e={name:t[i],sku:t[l],category:t[c],price:Number(t[o]),stock:Number(t[m]),minStock:Number(t[h])};await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),j++}catch(e){v++,console.error(`Error importing row ${s+1}:`,e)}}p({title:"Import Selesai",description:`${j} produk berhasil diimpor, ${v} gagal`}),t(),s(),n(null),x(null),u([]),d(!1)},k=(e="csv")=>{let s=[["name","sku","category","price","stock","min_stock"],["Contoh Produk","SKU001","Makanan","15000","100","10"],["Produk Lain","SKU002","Minuman","8000","50","5"]];"excel"===e?(0,$.pq)({headers:s[0],rows:s.slice(1),filename:"template-import-produk"}):(0,$.GS)({headers:s[0],rows:s.slice(1),filename:"template-import-produk"})};return a.jsx(N.Vq,{open:e,onOpenChange:s,children:(0,a.jsxs)(N.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx(N.fK,{children:a.jsx(N.$N,{children:"Import Produk"})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(y._,{htmlFor:"csv-file",children:"Pilih File"}),a.jsx(o.I,{id:"csv-file",type:"file",accept:".csv,.xlsx,.xls",onChange:j,className:"mt-1"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"File harus berformat CSV atau Excel dengan kolom: name, sku, category, price, stock, min_stock"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>k("csv"),className:"flex-1 bg-transparent",children:[a.jsx(M.Z,{className:"h-4 w-4 mr-2"}),"Download Template CSV"]}),(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>k("excel"),className:"flex-1 bg-transparent",children:[a.jsx(M.Z,{className:"h-4 w-4 mr-2"}),"Download Template Excel"]})]}),h.length>0&&(0,a.jsxs)(I.bZ,{variant:"destructive",children:[a.jsx(Z,{className:"h-4 w-4"}),a.jsx(I.X,{children:a.jsx("ul",{className:"list-disc list-inside",children:h.map((e,s)=>a.jsx("li",{children:e},s))})})]}),m&&(0,a.jsxs)("div",{children:[a.jsx(y._,{children:"Preview Data (5 baris pertama)"}),a.jsx("div",{className:"mt-2 border rounded-md overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:m[0].map((e,s)=>a.jsx("th",{className:"px-3 py-2 text-left font-medium text-xs sm:text-sm",children:e},s))})}),a.jsx("tbody",{children:m.slice(1).map((e,s)=>a.jsx("tr",{className:"border-t",children:e.map((e,s)=>a.jsx("td",{className:"px-3 py-2 text-xs sm:text-sm",children:e},s))},s))})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-2",children:[a.jsx(c.z,{variant:"outline",onClick:s,className:"order-2 sm:order-1 bg-transparent",children:"Batal"}),a.jsx(c.z,{onClick:v,disabled:!i||l||h.length>0,className:"order-1 sm:order-2",children:l?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Mengimpor..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(A.Z,{className:"h-4 w-4 mr-2"}),"Import Data"]})})]})]})]})})}var F=t(27365),O=t(58875),q=t(41471),B=t(28214),L=t(94305);function z(){let{user:e,isLoading:s}=(0,i.a)();(0,n.useRouter)();let{toast:t}=(0,E.pm)(),[d,o]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[u,j]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),[y,b]=(0,r.useState)(null),[N,w]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),[I,M]=(0,r.useState)([]),[Z,z]=(0,r.useState)(0),[U,R]=(0,r.useState)(!0),G=async e=>{if(confirm("Apakah Anda yakin ingin menghapus produk ini?")){C(!0);try{await fetch(`/api/products?id=${e}`,{method:"DELETE"}),t({title:"Produk dihapus",description:"Produk berhasil dihapus dari inventory"}),z(e=>e+1)}catch(e){t({title:"Gagal menghapus produk",description:"Terjadi kesalahan saat menghapus produk",variant:"destructive"})}finally{C(!1)}}},K=async(e,s)=>{let t=I.find(s=>s.id===e);t&&(1===s||-1===s?await H(t,s):(v(t),h(!0)))},H=async(e,s)=>{C(!0);try{let a=Math.max(0,e.stock+s);await fetch("/api/products",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,stock:a})}),t({title:"Stok disesuaikan",description:`Stok ${e.name} ${s>0?"ditambah":"dikurangi"} ${Math.abs(s)}`}),z(e=>e+1)}catch(e){t({title:"Gagal menyesuaikan stok",description:"Terjadi kesalahan saat menyesuaikan stok",variant:"destructive"})}finally{C(!1)}},J=async e=>{C(!0);try{if(g){let s={id:g.id,...e};void 0!==s.minStock&&(s.minStock=Number(s.minStock)),void 0!==s.costPrice&&(s.costPrice=Number(s.costPrice)),await fetch("/api/products",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t({title:"Produk diperbarui",description:"Informasi produk berhasil diperbarui"})}else{let s={...e};await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t({title:"Produk ditambahkan",description:"Produk baru berhasil ditambahkan ke inventory"})}o(!1),v(null),z(e=>e+1)}catch(e){t({title:"Gagal menyimpan produk",description:"Terjadi kesalahan saat menyimpan produk",variant:"destructive"})}finally{C(!1)}},V=async(e,s,a)=>{if(g){C(!0);try{let s=I.find(e=>e.id===g.id)?.stock||0;await fetch("/api/products",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:g.id,stock:"add"===a?s+e:Math.max(0,s-e)})}),t({title:"Stok disesuaikan",description:`Stok ${g.name} berhasil ${"add"===a?"ditambah":"dikurangi"}`}),h(!1),v(null),z(e=>e+1)}catch(e){t({title:"Gagal menyesuaikan stok",description:"Terjadi kesalahan saat menyesuaikan stok",variant:"destructive"})}finally{C(!1)}}},W=(e="csv")=>{if("json"===e){(0,$.cs)(I,`products-${new Date().toISOString().split("T")[0]}`),t({title:"Export Berhasil",description:"Data produk berhasil diekspor ke JSON"});return}let s={headers:["Nama Produk","SKU","Kategori","Harga","Stok","Stok Minimum","Status"],rows:I.map(e=>[e.name,e.sku,e.category,e.price,e.stock,e.min_stock,e.stock<=e.min_stock?"Stok Menipis":"Normal"]),filename:`products-${new Date().toISOString().split("T")[0]}`};"excel"===e?((0,$.pq)(s),t({title:"Export Berhasil",description:"Data produk berhasil diekspor ke Excel"})):((0,$.GS)(s),t({title:"Export Berhasil",description:"Data produk berhasil diekspor ke CSV"}))};if(s)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Memuat..."})]})});if(!e||"kasir"===e.role)return null;let X=I.length,Y=I.filter(e=>e.stock<=e.min_stock).length,Q=I.filter(e=>0===e.stock).length,ee=I.reduce((e,s)=>e+s.price*s.stock,0);return a.jsx(l.c,{title:"Manajemen Inventory",children:(0,a.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[(0,a.jsxs)(F.Zb,{children:[(0,a.jsxs)(F.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(F.ll,{className:"text-xs md:text-sm font-medium",children:"Total Produk"}),a.jsx(O.Z,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(F.aY,{children:U?a.jsx("div",{className:"h-6 md:h-8 bg-gray-200 rounded animate-pulse"}):a.jsx("div",{className:"text-lg md:text-2xl font-bold",children:X})})]}),(0,a.jsxs)(F.Zb,{children:[(0,a.jsxs)(F.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(F.ll,{className:"text-xs md:text-sm font-medium",children:"Stok Menipis"}),a.jsx(q.Z,{className:"h-4 w-4 text-orange-500"})]}),a.jsx(F.aY,{children:U?a.jsx("div",{className:"h-6 md:h-8 bg-gray-200 rounded animate-pulse"}):a.jsx("div",{className:"text-lg md:text-2xl font-bold text-orange-600",children:Y})})]}),(0,a.jsxs)(F.Zb,{children:[(0,a.jsxs)(F.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(F.ll,{className:"text-xs md:text-sm font-medium",children:"Stok Habis"}),a.jsx(q.Z,{className:"h-4 w-4 text-red-500"})]}),a.jsx(F.aY,{children:U?a.jsx("div",{className:"h-6 md:h-8 bg-gray-200 rounded animate-pulse"}):a.jsx("div",{className:"text-lg md:text-2xl font-bold text-red-600",children:Q})})]}),(0,a.jsxs)(F.Zb,{children:[(0,a.jsxs)(F.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(F.ll,{className:"text-xs md:text-sm font-medium",children:"Nilai Inventory"}),a.jsx(B.Z,{className:"h-4 w-4 text-green-500"})]}),a.jsx(F.aY,{children:U?a.jsx("div",{className:"h-6 md:h-8 bg-gray-200 rounded animate-pulse"}):a.jsx("div",{className:"text-base md:text-2xl font-bold text-green-600",children:(0,f.xG)(ee)})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg md:text-xl font-semibold",children:"Daftar Produk"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Kelola produk dan stok inventory"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 w-full sm:w-auto",children:[(0,a.jsxs)(x.h_,{children:[a.jsx(x.$F,{asChild:!0,children:(0,a.jsxs)(c.z,{variant:"outline",size:"sm",className:"flex items-center gap-2 bg-transparent",children:[a.jsx(L.Z,{className:"h-4 w-4"}),"Export"]})}),(0,a.jsxs)(x.AW,{align:"end",children:[a.jsx(x.Xi,{onClick:()=>W("excel"),children:"Export Excel (.xlsx)"}),a.jsx(x.Xi,{onClick:()=>W("csv"),children:"Export CSV"}),a.jsx(x.Xi,{onClick:()=>W("json"),children:"Export JSON"})]})]}),(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>j(!0),size:"sm",children:[a.jsx(A.Z,{className:"h-4 w-4 mr-2"}),"Import"]}),(0,a.jsxs)(c.z,{onClick:()=>o(!0),size:"sm",className:"w-full sm:w-auto",children:[a.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Tambah Produk"]})]})]}),a.jsx(k,{onEditProduct:e=>{v(e),o(!0)},onDeleteProduct:G,onAdjustStock:K,onViewProduct:e=>{b(e),w(!0)},refreshTrigger:Z}),a.jsx(P,{product:g,isOpen:d,onClose:()=>{o(!1),v(null)},onSave:J,isLoading:S}),a.jsx(T,{isOpen:m,onClose:()=>{h(!1),v(null)},onAdjust:V,productName:g?.name||"",currentStock:g?.stock||0,isLoading:S}),a.jsx(_,{product:y,isOpen:N,onClose:()=>{w(!1),b(null)}}),a.jsx(D,{isOpen:u,onClose:()=>j(!1),onImportComplete:()=>{z(e=>e+1),t({title:"Import Berhasil",description:"Produk berhasil diimpor ke inventory"})}})]})})}},82546:(e,s,t)=>{"use strict";t.d(s,{X:()=>d,bZ:()=>l});var a=t(51582);t(61751);var r=t(95451),i=t(51366);let n=(0,r.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,...t}){return a.jsx("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(n({variant:s}),e),...t})}function d({className:e,...s}){return a.jsx("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...s})}},24358:(e,s,t)=>{"use strict";function a(e){let s=new Blob([[e.headers.join(","),...e.rows.map(e=>e.map(e=>"string"==typeof e&&e.includes(",")?`"${e.replace(/"/g,'""')}"`:e).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");if(void 0!==t.download){let a=URL.createObjectURL(s);t.setAttribute("href",a),t.setAttribute("download",`${e.filename}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}function r(e,s){let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){let e=URL.createObjectURL(t);a.setAttribute("href",e),a.setAttribute("download",`${s}.json`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}function i(e){let s=e.split("\n"),t=[];for(let e of s)if(e.trim()){let s=[],a="",r=!1;for(let t=0;t<e.length;t++){let i=e[t];'"'===i?r=!r:","!==i||r?a+=i:(s.push(a.trim()),a="")}s.push(a.trim()),t.push(s)}return t}function n(e){let s={SheetNames:["Sheet1"],Sheets:{Sheet1:{}}},t={};e.headers.forEach((e,s)=>{t[String.fromCharCode(65+s)+"1"]={v:e,t:"s"}}),e.rows.forEach((e,s)=>{e.forEach((e,a)=>{t[String.fromCharCode(65+a)+(s+2)]={v:e,t:"number"==typeof e?"n":"s"}})});let a=`A1:${String.fromCharCode(65+e.headers.length-1)}${e.rows.length+1}`;t["!ref"]=a,s.Sheets.Sheet1=t;let r=new Blob([function(e){let s=new ArrayBuffer(e.length),t=new Uint8Array(s);for(let s=0;s<e.length;s++)t[s]=255&e.charCodeAt(s);return s}(function(e){let s;let t=new Map;t.set("[Content_Types].xml",`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
<Default Extension="xml" ContentType="application/xml"/>
<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>
<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>
</Types>`),t.set("_rels/.rels",`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>
</Relationships>`),t.set("xl/_rels/workbook.xml.rels",`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>
</Relationships>`),t.set("xl/workbook.xml",`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">
<sheets><sheet name="Sheet1" sheetId="1" r:id="rId1" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/></sheets>
</workbook>`);let a=e.Sheets.Sheet1,r="<sheetData>";if(a["!ref"]){let e=d(a["!ref"]);for(let s=e.s.r;s<=e.e.r;s++){r+=`<row r="${s+1}">`;for(let t=e.s.c;t<=e.e.c;t++){let e=o({r:s,c:t}),i=a[e];if(i){let s="n"===i.t?"":' t="inlineStr"',t="n"===i.t?`<v>${i.v}</v>`:`<is><t>${String(i.v).replace(/[<>&'"]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;";default:return e}})}</t></is>`;r+=`<c r="${e}"${s}>${t}</c>`}}r+="</row>"}}return r+="</sheetData>",t.set("xl/worksheets/sheet1.xml",`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">
${r}
</worksheet>`),s="",t.forEach((e,t)=>{s+=e}),s}(s))],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=document.createElement("a");if(void 0!==i.download){let s=URL.createObjectURL(r);i.setAttribute("href",s),i.setAttribute("download",`${e.filename}.xlsx`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}function l(e){return new Promise((s,t)=>{let a=new FileReader;a.onload=e=>{try{new Uint8Array(e.target?.result);let t={SheetNames:["Sheet1"],Sheets:{Sheet1:{"!ref":"A1:A1",A1:{v:"Sample",t:"s"}}}},a=t.SheetNames[0],r=t.Sheets[a],i=[],n=r["!ref"];if(!n){s([]);return}let l=d(n);for(let e=l.s.r;e<=l.e.r;e++){let s=[];for(let t=l.s.c;t<=l.e.c;t++){let a=r[o({r:e,c:t})];s.push(a?String(a.v):"")}i.push(s)}s(i)}catch(e){t(e)}},a.onerror=()=>t(Error("Failed to read file")),a.readAsArrayBuffer(e)})}function d(e){let s=e.split(":"),t=c(s[0]),a=s[1]?c(s[1]):t;return{s:t,e:a}}function c(e){let s=e.match(/([A-Z]+)(\d+)/);if(!s)return{r:0,c:0};let t=s[1].split("").reduce((e,s)=>26*e+s.charCodeAt(0)-64,0)-1;return{r:Number.parseInt(s[2])-1,c:t}}function o(e){let s="",t=e.c;for(;t>=0;)s=String.fromCharCode(65+t%26)+s,t=Math.floor(t/26)-1;return s+(e.r+1)}t.d(s,{GS:()=>a,bW:()=>i,cs:()=>r,gY:()=>l,pq:()=>n})},94305:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(75475).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},63632:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(75475).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},95151:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(75475).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},28214:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(75475).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},41471:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(75475).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1817:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(75475).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},80156:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(29682).createProxy)(String.raw`/workspace/app/inventory/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[6325,7985,5958,5058,881,7927,2604,5425],()=>t(90294));module.exports=a})();